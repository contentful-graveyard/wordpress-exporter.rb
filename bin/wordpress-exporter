#!/usr/bin/env ruby

require 'escort'
require_relative '../lib/cli'

I18n.enforce_available_locales = false
spec = Gem::Specification.find_by_name('wordpress-exporter')
$gem_root = spec.gem_dir

Escort::App.create do |app|
  app.summary 'Executable file of Wordpress exporter'
  app.options do |opts|
    opts.opt :file, '--config-file', short: '-f', long: '--config-file', type: :string
    app.command '--extract-to-json' do |command|
      command.summary 'Extract data from Wordpress XML dump file and save as JSON files'
      command.options do |opts|
        opts.opt :omit_content_model, 'omit', short: '-o', long: '--omit-content-model', type: :boolean, default: false
      end
      command.action do |options, arguments|
        Command::CLI.new(options, arguments).execute
      end
    end
    app.command '--create-contentful-model-from-json' do |command|
      command.summary 'Query data from Database'
      command.action do |options, arguments|
        Command::CLI.new(options, arguments).execute
      end
    end
    app.command '--convert-content-model-to-json' do |command|
      command.summary 'Convert dump file from Contentful model to import form. View README'
      command.action do |options, arguments|
        Command::CLI.new(options, arguments).execute
      end
    end

    app.command '--convert-markup' do |command|
      command.summary 'Convert markup to markdown in post content. View README'
      command.action do |options, arguments|
        Command::CLI.new(options, arguments).execute
      end
    end
  end
end
